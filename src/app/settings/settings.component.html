<app-page-shell (messageEvent)="loginClicked ($event)" [userId]="userId" [imgSrcFile]="imgSrcFile"
    [pageTitle]="'Settings'" [headerObj]="headerObj" [userStatus]="userStatus" [stickyBottomFlg]="true">

    <!--<app-upload-image-crop [src]="user.imgSrc"></app-upload-image-crop>-->

    <div class="matches-card" *ngIf="user">
        <div>- Settings -</div>
        <button (mousedown)="logout()" class="btn btn-main-color"><i class="fa fa-sign-out"></i>
            Logout</button>&nbsp;
        <button (mousedown)="showStats()" class="btn btn-main-color"><i class="fa fa-line-chart"></i>
            stats</button>&nbsp;
        <button (mousedown)="showLocation()" class="btn btn-main-color"><i class="fa fa-globe"></i>
            location</button>&nbsp;
        <button *ngIf="!user.memberFlg" [routerLink]="'/upgrade-member'" class="btn btn-main-color"><i
                class="fa fa-arrow-up"></i>
            Upgrade</button>&nbsp;
        <button (mousedown)="redoMatchesFlg=!redoMatchesFlg" class="btn btn-main-color"><i
                class="fa fa-refresh"></i>
            Redo Matches</button>&nbsp;

        <div *ngIf="!user.lat" class="border-box">
            <p class="red-text">Note: Something is not set up properly with your location</p>
            <p>Click the "Location" button, then "Find Location" and then press "Update" to fix.</p>
            <p class="gray-text">If this doesn't fix your issue, you will need to log in with a different device or
                change your browser settings to allow location info.</p>
        </div>
        <div *ngIf="redoMatchesFlg" class="tan-box">
            <div class="gray-text">Would you like to reset all the people who you said 'No' to so you can browse through them again?</div>
            <button (mousedown)="redoMatchesFlg=false" class="btn btn-warning">Cancel</button>&nbsp;
            <select name="resetRange" id="resetRange">
                <option>All Profiles</option>
                <option>Past Week</option>
                <option>Past Month</option>
            </select>&nbsp;
            <button (mousedown)="resetMatchesPressed()" class="btn btn-main-color">Reset Matches</button>
        </div>
        <div *ngIf="showLocationFlg" class="border-box">
            <div>Location</div>
            <div class="gray-text">If you have moved to a new location and want to update the database, click the "Find
                Location" button below,
                and then press "Update" to update the database.
            </div>
            <div *ngIf="geoUpdatedFlg">Your location data has been updated!</div>
            <div id="gpsDataError" style="background-color: yellow;">{{gpsDataError}}</div>
            <table *ngIf="!geoUpdatedFlg" style="font-size: 12px;">
                <tr>
                    <th>Item</th>
                    <th>Current Location</th>
                    <th>New Location</th>
                </tr>
                <tr>
                    <td>City</td>
                    <td><span class="text-highlight">{{user.city}}</span></td>
                    <td><span class="text-highlight">{{city}}</span></td>
                </tr>
                <tr>
                    <td>State</td>
                    <td><span class="text-highlight">{{user.state}}</span></td>
                    <td><span class="text-highlight">{{state}}</span></td>
                </tr>
                <tr>
                    <td>Country</td>
                    <td><span class="text-highlight">{{user.countryName}}</span></td>
                    <td><span class="text-highlight">{{country}}</span></td>
                </tr>
                <tr>
                    <td>GPS1</td>
                    <td><span class="text-highlight">{{user.gpsLat}}</span></td>
                    <td><span class="text-highlight">{{lat1}}</span></td>
                </tr>
                <tr>
                    <td>GPS2</td>
                    <td><span class="text-highlight">{{user.navLat}}</span></td>
                    <td><span class="text-highlight" id="lat2">{{lat2}}</span></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td align="center">
                        <button class="btn btn-main-color" *ngIf="!findingLocationDataFlg"
                            (mousedown)="findLocalData()">
                            <i class="fa fa-globe"></i> Find Location</button>
                        <i *ngIf="findingLocationDataFlg" class="fa fa-spinner fa-spin"></i>
                        <div style="margin-top: 2px;">
                            <button (mousedown)="updateLocation()" [disabled]="updateLocationDisabledFlg"
                                class="btn btn-success" style="height: 60px;"><i class="fa fa-map-pin"></i>
                                Update</button>&nbsp;
                        </div>
                        <div class="gray-text">Update to this new location</div>

                    </td>
                </tr>
            </table>


            <div style="color: #eee; font-size: 10px;">{{user.latitude}} {{user.longitude}}</div>

        </div>

        <app-spinner [loadingFlg]="loadingFlg" [errorMessage]="errorMessage"></app-spinner>
        <div *ngIf="showStatsFlg">
            <div><b>Betra Stats</b></div>
            <div style="font-size: 10px;">
                <div>Version: <span class="text-highlight">{{version}}</span></div>
                <div>Browser: <span class="text-highlight">{{browser}}</span></div>
                <div>Platform: <span class="text-highlight">{{platform}}</span></div>
            </div>
            <table width="100%" *ngIf="responseJson && !loadingFlg">
                <tr>
                    <td valign="top">
                        <div class="border-box" style="font-size: 12px;">
                            <div class="tiny-text">Accounts</div>
                            <div>Total Created: {{responseJson.accounts}}</div>
                            <div>*Newly Created: {{responseJson.newThisWeek}}</div>
                            <div>Active Status: {{responseJson.activeAccounts}}</div>
                            <div>*Recently Logged In: {{responseJson.recentLogins}}</div>
                            <div style="font-size: 8px; color: gray;">* past 7 days</div>
                        </div>
                        <div class="border-box">
                            <div class="tiny-text">Likes: {{responseJson.likes}}</div>
                            <div class="tiny-text">Matches: {{responseJson.matches}}</div>
                            <div class="tiny-text">Messages: {{responseJson.messages}}</div>
                            <div class="tiny-text">Reviews: {{responseJson.reviews}}</div>
                        </div>
                    </td>
                    <td valign="top">
                        <div class="border-box" style="font-size: 12px;">
                            <div class="tiny-text">Countries</div>
                            <div *ngFor="let country of responseJson.countryNames">
                                <div>{{country.countryName}}<sup>{{country.count}}</sup></div>
                            </div>
                        </div>
                        <div class="border-box" style="font-size: 12px;">
                            <div class="tiny-text">States</div>
                            <div *ngFor="let state of responseJson.stateName">
                                <div>{{state.stateName}}<sup>{{state.count}}</sup></div>
                            </div>
                        </div>
                    </td>
                    <td valign="top">
                        <div class="border-box" style="font-size: 8px; max-width: 200px;">
                            <div class="tiny-text">Cities</div>
                            <span *ngFor="let city of responseJson.cities">
                                {{city.name}}<sup>{{city.count}}</sup>
                            </span>
                        </div>
                    </td>
                </tr>
            </table>
        </div>



        <div *ngIf="userId==1">
            <p>&nbsp;</p>
            <button [routerLink]="['/users']" class="btn btn-primary"><i class="fa fa-users"></i>
                Users</button>&nbsp;
            <button [routerLink]="['/documentation']" class="btn btn-primary"><i class="fa fa-file-text"></i>
                Documentation</button>
        </div>




    </div>

</app-page-shell>